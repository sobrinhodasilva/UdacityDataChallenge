
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Visualiza??o dos Dados de comportamento }
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}489}]:} \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
          \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
          \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
          
          \PY{c+c1}{\PYZsh{}configuracao gáficos}
          \PY{n}{plt}\PY{o}{.}\PY{n}{style}\PY{o}{.}\PY{n}{use}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{seaborn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{figure.figsize}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}
          \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
          
          \PY{c+c1}{\PYZsh{}inicializra plotly no nootebook }
          \PY{n}{py}\PY{o}{.}\PY{n}{init\PYZus{}notebook\PYZus{}mode}\PY{p}{(}\PY{n}{connected} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}490}]:} \PY{n}{df\PYZus{}spend\PYZus{}train} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{data/spend\PYZus{}train.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \subsection{Análise da dispersão dos
dados}\label{anuxe1lise-da-dispersuxe3o-dos-dados}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}462}]:} \PY{n}{df\PYZus{}spend\PYZus{}train}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}462}]:}                                     ids  credit\_line  month    spends  \textbackslash{}
          0  b4118fd5-77d5-4d80-3617-bacd7aaf1a88        17941      0   6305.06   
          1  b4118fd5-77d5-4d80-3617-bacd7aaf1a88        17941      1   4199.99   
          2  b4118fd5-77d5-4d80-3617-bacd7aaf1a88        17941      2   7167.94   
          3  b4118fd5-77d5-4d80-3617-bacd7aaf1a88        17941      3  16631.05   
          4  b4118fd5-77d5-4d80-3617-bacd7aaf1a88        17941      4    115.29   
          
             revolving\_balance  card\_request  minutes\_cs  
          0              35.56             1        0.00  
          1            3406.59             0        0.00  
          2               0.00             0        0.00  
          3               0.00             1        5.55  
          4               0.00             0        6.89  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}463}]:} \PY{n}{df\PYZus{}spend\PYZus{}train}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}463}]:}          credit\_line          month         spends  revolving\_balance  \textbackslash{}
          count  980818.000000  980818.000000  980818.000000      980818.000000   
          mean     6450.701643      12.103346    2878.074202         481.071351   
          std      4564.596250       8.515882    3529.032134        1431.827450   
          min       506.000000       0.000000       0.000000           0.000000   
          25\%      2948.000000       5.000000     334.760000           0.000000   
          50\%      5314.000000      11.000000    1568.165000           1.530000   
          75\%      8763.000000      18.000000    4129.000000         141.660000   
          max     20484.000000      35.000000   20462.230000       20369.440000   
          
                  card\_request     minutes\_cs  
          count  980818.000000  980818.000000  
          mean        0.092795       2.791051  
          std         0.290145       6.644611  
          min         0.000000       0.000000  
          25\%         0.000000       0.000000  
          50\%         0.000000       0.000000  
          75\%         0.000000       1.720000  
          max         1.000000      75.580000  
\end{Verbatim}
            
    Grafico da ditribuiçao do limite de credito concedido a cada 100 reais

    f = df.groupby('source')\\
.agg(\{'text':'size', 'sent':'mean'\})\\
.rename(columns=\{'text':'count','sent':'mean\_sent'\})\\
.reset\_index()

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}500}]:} \PY{n}{df\PYZus{}disp} \PY{o}{=} \PY{n}{df\PYZus{}spend\PYZus{}train}
          \PY{n}{df\PYZus{}disp}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}credit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n}{df\PYZus{}disp}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{credit\PYZus{}line}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{l+m+mi}{500}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{500}
          
          \PY{n}{gp\PYZus{}id\PYZus{}creLine} \PY{o}{=} \PY{n}{df\PYZus{}disp}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ids}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}credit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}credit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}
          \PY{n}{gp\PYZus{}id\PYZus{}creLine}\PY{o}{.}\PY{n}{plot}\PY{p}{(} \PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bar}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{]}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Grupos de Limite de Crédito}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Grupo}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Faturas}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_7_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    O grafico acima conta quantos registros estão no intervalo e não quantos
clientes como queriamos

    \subsection{Análise por Cliente}\label{anuxe1lise-por-cliente}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}465}]:} \PY{c+c1}{\PYZsh{}agrupamos os registro por cliente }
          \PY{n}{group\PYZus{}media} \PY{o}{=} \PY{n}{df\PYZus{}disp}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ids}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PYZbs{}
                              \PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{credit\PYZus{}line}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spends}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{revolving\PYZus{}balance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}  \PYZbs{}
                              \PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}466}]:} \PY{c+c1}{\PYZsh{}quantidade de cliente }
          \PY{n}{group\PYZus{}media}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}466}]:}         credit\_line        spends  revolving\_balance
          count  45000.000000  45000.000000       45000.000000
          mean    6441.681511   2871.454454         481.374504
          std     4556.101062   2139.259699         465.824551
          min      506.000000     12.296667           0.000000
          25\%     2949.000000   1225.933536         150.497159
          50\%     5302.000000   2300.543842         338.740417
          75\%     8737.000000   3953.112462         666.310946
          max    20484.000000  15705.142000        8774.574000
\end{Verbatim}
            
    \section{Total de Clientes: 45000}\label{total-de-clientes-45000}

    quantos desses clientes nunca atrasaram ?

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}467}]:} \PY{n}{df\PYZus{}adiplentes} \PY{o}{=} \PY{n}{df\PYZus{}spend\PYZus{}train}
          \PY{n}{df\PYZus{}adiplentes} \PY{o}{=} \PY{n}{df\PYZus{}adiplentes}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{revolving\PYZus{}balance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ids}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ids}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
          \PY{n}{df\PYZus{}adiplentes} \PY{p}{[}\PY{n}{df\PYZus{}adiplentes}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{revolving\PYZus{}balance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{0}  \PY{p}{]}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}467}]:} revolving\_balance    25
          dtype: int64
\end{Verbatim}
            
    \subsubsection{Conclusão}\label{conclusuxe3o}

Esse dataset paraticamente todos atrasaram alguma fatura o que nos leva
a crer que \textbf{é a base de inadiplentes da carteira}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}468}]:} \PY{c+c1}{\PYZsh{}criar grupo para os valores de média  }
          \PY{n}{group\PYZus{}media}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}credit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n}{group\PYZus{}media}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{credit\PYZus{}line}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{l+m+mi}{500}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{500}
          \PY{n}{group\PYZus{}media}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}gastos}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n}{group\PYZus{}media}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spends}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{l+m+mi}{100}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}469}]:} \PY{n}{grafico} \PY{o}{=} \PY{n}{group\PYZus{}media}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ids}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}credit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}credit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PYZbs{}
              \PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{area}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{title} \PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Quantidade de Cliente Por Faixa de Limite de Crédito}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{]}\PY{p}{)}
          
          \PY{n}{grafico}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Limite R\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ylabel}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Qtde Clientes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}469}]:} [Text(0, 0.5, 'Qtde Clientes'), Text(0.5, 0, 'Limite R\$')]
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_17_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Sabemos que a quantidade de clientes devedores estao tem limites até
\textbackslash{}\$ 7500\\
mas isso pode ser por que deve ter a maioria de clientes nesse intervalo
e também percebemos um pico no grupo de \textbackslash{}\$ 20k

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}470}]:} \PY{n}{grf\PYZus{}gasto} \PY{o}{=} \PY{n}{group\PYZus{}media}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ids}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}gastos}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}gastos}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PYZbs{}
              \PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{area}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{title} \PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Quantidade de Cliente Por Faixa de Gasto}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{]}\PY{p}{)}
          \PY{n}{grf\PYZus{}gasto}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Gasto médio R\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ylabel}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Qtde Clientes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}470}]:} [Text(0, 0.5, 'Qtde Clientes'), Text(0.5, 0, 'Gasto médio R\$')]
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_19_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Maioria dos clientes devedores gastam em média até
\textbackslash{}\$3mil por
fatura}\label{maioria-dos-clientes-devedores-gastam-em-muxe9dia-atuxe9-3mil-por-fatura}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}471}]:} \PY{n}{group\PYZus{}media}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}divida}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n}{group\PYZus{}media}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{revolving\PYZus{}balance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{l+m+mi}{100}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}
          \PY{n}{grf\PYZus{}divida} \PY{o}{=} \PY{n}{group\PYZus{}media}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ids}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}divida}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}divida}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PYZbs{}
              \PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{title} \PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Quantidade de Cliente Por Faixa de Divida }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}   \PY{n}{figsize} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{]}\PY{p}{)}
          \PY{n}{grf\PYZus{}divida}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Divida média R\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ylabel}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Qtde Clientes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}471}]:} [Text(0, 0.5, 'Qtde Clientes'), Text(0.5, 0, 'Divida média R\$')]
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_21_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{\texorpdfstring{Percebemos que a maioria dos cliente
atrasam em média valores \textbf{\textless{}
\$1000}}{Percebemos que a maioria dos cliente atrasam em média valores \textless{} \$1000}}\label{percebemos-que-a-maioria-dos-cliente-atrasam-em-muxe9dia-valores-1000}

    \subsection{Analise de dívida em relacao ao limite e ao gasto do
mes}\label{analise-de-duxedvida-em-relacao-ao-limite-e-ao-gasto-do-mes}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}472}]:} \PY{n}{df\PYZus{}divida} \PY{o}{=} \PY{n}{df\PYZus{}spend\PYZus{}train}
          \PY{n}{df\PYZus{}divida}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dif\PYZus{}divida\PYZus{}limite}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=}  \PY{n}{df\PYZus{}divida}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{revolving\PYZus{}balance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{/} \PY{n}{df\PYZus{}divida}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{credit\PYZus{}line}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} 
          \PY{n}{df\PYZus{}divida}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dif\PYZus{}divida\PYZus{}gasto}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}divida}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{revolving\PYZus{}balance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{/} \PY{n}{df\PYZus{}divida}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spends}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} 
          \PY{n}{df\PYZus{}divida}\PY{o}{.}\PY{n}{dif\PYZus{}divida\PYZus{}gasto}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n}{df\PYZus{}divida}\PY{p}{[}\PY{n}{df\PYZus{}divida}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dif\PYZus{}divida\PYZus{}gasto}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{.}\PY{l+m+mi}{8}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}472}]:}                                          ids  credit\_line  month    spends  \textbackslash{}
          1       b4118fd5-77d5-4d80-3617-bacd7aaf1a88        17941      1   4199.99   
          30      a75638f1-4662-4f4f-044a-d649b676d85d        12717     10   7015.36   
          39      a75638f1-4662-4f4f-044a-d649b676d85d        12717     19     10.42   
          44      e643bf65-9288-92f2-df13-eed631fe237c         4997      2   4371.41   
          45      e643bf65-9288-92f2-df13-eed631fe237c         4997      3    808.46   
          58      e643bf65-9288-92f2-df13-eed631fe237c         4997     16   4931.72   
          71      b84024d8-a5ba-6c59-9133-1335c4a0a57d         5913      0   3425.53   
          73      b84024d8-a5ba-6c59-9133-1335c4a0a57d         5913      2    485.16   
          74      b84024d8-a5ba-6c59-9133-1335c4a0a57d         5913      3   5645.41   
          79      b84024d8-a5ba-6c59-9133-1335c4a0a57d         5913      8   5848.97   
          81      b84024d8-a5ba-6c59-9133-1335c4a0a57d         5913     10    398.55   
          83      b84024d8-a5ba-6c59-9133-1335c4a0a57d         5913     12    242.78   
          92      b84024d8-a5ba-6c59-9133-1335c4a0a57d         5913     21   2960.48   
          96      b84024d8-a5ba-6c59-9133-1335c4a0a57d         5913     25    679.54   
          116     8a66ed52-97b1-967f-132c-a5035c130d74         8494      9   6428.39   
          139     b8de2a5e-47b2-c03d-7997-0a85d402f9c2        12617     15    441.81   
          148     63ada984-e40a-85f5-1cef-c708be59ef93         6082      5   3071.73   
          158     0854e48f-3ad0-8ba0-0d3f-97c8d62b4ecd         6813      1   6665.04   
          175     8689dcdb-b305-280b-7e9b-ffd8e6a20dd0         4253      6   4226.17   
          193     8689dcdb-b305-280b-7e9b-ffd8e6a20dd0         4253     24    607.93   
          195     8689dcdb-b305-280b-7e9b-ffd8e6a20dd0         4253     26    195.38   
          216     4322258a-9ea8-ef72-b3b2-bd7dba7a1d4c         5478     12   5316.69   
          243     5e32067b-d9f9-2384-36f1-0fb678511168         7188     15   1342.92   
          246     739eec7d-ae35-dcd2-7dc4-973f52ba3495         5267      2   1854.11   
          267     739eec7d-ae35-dcd2-7dc4-973f52ba3495         5267     23   3007.11   
          270     739eec7d-ae35-dcd2-7dc4-973f52ba3495         5267     26   4095.70   
          289     4c104001-1125-6988-05ed-f12d248f76db        11329     12     56.12   
          292     4c104001-1125-6988-05ed-f12d248f76db        11329     15   9620.39   
          302     73e39a95-d30e-93cd-5112-68c017b4bcf5        10247      2  10078.13   
          314     73e39a95-d30e-93cd-5112-68c017b4bcf5        10247     14    962.52   
          {\ldots}                                      {\ldots}          {\ldots}    {\ldots}       {\ldots}   
          980409  c84db585-b9c5-d13b-7407-af269f0ab229        16085      4    615.18   
          980414  e64e9d4f-225d-d1f1-1c54-8ce31f179d7c         6248      0   5389.00   
          980417  e64e9d4f-225d-d1f1-1c54-8ce31f179d7c         6248      3   5422.04   
          980429  438807f1-0b85-9154-8371-f0e0f040541e         6745     11   4451.53   
          980438  c7db3baf-b2b6-041c-7867-c3d1f9652911        10274      4   8611.20   
          980471  55182462-66de-d2cc-8573-5b4cdfad8184         7948      0    719.17   
          980474  55182462-66de-d2cc-8573-5b4cdfad8184         7948      3   1989.19   
          980481  55182462-66de-d2cc-8573-5b4cdfad8184         7948     10   2632.45   
          980490  a978168a-d19b-628e-36a3-73223b01f112         8544      0   7250.06   
          980495  a978168a-d19b-628e-36a3-73223b01f112         8544      5   8440.94   
          980500  a978168a-d19b-628e-36a3-73223b01f112         8544     10   4362.07   
          980514  1b1db5db-8ccf-9f0b-e5ca-53010aff3c6f         4533     11   1537.45   
          980520  97c2b774-8878-df4e-76fa-3222514115aa         7474      2   1740.51   
          980549  5710fa7f-ad6d-489b-3f9e-b6730620fd04        10432      6    745.09   
          980593  d4a8ce45-80af-639d-883f-37a99499f0b5         5864      6   5700.53   
          980594  d4a8ce45-80af-639d-883f-37a99499f0b5         5864      7     61.62   
          980603  d5945403-c10b-7ed6-4f42-8a553a40ab6e         1926      2   1708.37   
          980604  d5945403-c10b-7ed6-4f42-8a553a40ab6e         1926      3   1194.05   
          980619  e4cfd9c5-9f76-fed0-6a57-3b796fc3ab4a         2006      0     59.12   
          980636  9524c170-89e6-01a3-f348-700ae08c4751         4538      1   2090.76   
          980645  0280a376-9313-2bac-b55f-cd4f99ba8a17         3831      5    167.08   
          980646  0280a376-9313-2bac-b55f-cd4f99ba8a17         3831      6   3131.24   
          980657  9e77f36a-baa3-55e1-5733-c47bd9af2db8         5581      9    808.01   
          980679  6f9b9b79-f34e-b00a-1dc8-aaecbfb2e184         9079      1   7024.85   
          980713  795f75e6-d0a4-4743-d542-6def4edebc00          948      3    938.67   
          980730  3c1c03b8-b4d0-9b10-c6ec-bc3b89c8657b        11079      1     56.93   
          980773  278c33d9-13fe-6fa1-e3d6-b3baf631f54d         3759      2    297.81   
          980799  fd9241aa-7008-0dc9-4ebb-f0e30528bca2         6655     10   6644.48   
          980803  9b5f1371-1224-8884-8851-ec92f4351c72         2631      0   2161.37   
          980805  9b5f1371-1224-8884-8851-ec92f4351c72         2631      2     44.04   
          
                  revolving\_balance  card\_request  minutes\_cs  cat\_credit  \textbackslash{}
          1                 3406.59             0        0.00     18000.0   
          30                6836.73             0       17.22     12500.0   
          39                  10.36             0        3.35     12500.0   
          44                4316.68             0        0.00      5000.0   
          45                 754.77             0        0.00      5000.0   
          58                4628.84             0        0.00      5000.0   
          71                3151.48             1        1.84      6000.0   
          73                 423.15             0        0.00      6000.0   
          74                5632.74             0        0.00      6000.0   
          79                5281.47             0        0.00      6000.0   
          81                 386.26             0        0.00      6000.0   
          83                 213.98             0        0.00      6000.0   
          92                2949.50             0        0.00      6000.0   
          96                 625.02             0        0.00      6000.0   
          116               6279.53             0        1.68      8500.0   
          139                364.99             0        0.00     12500.0   
          148               3008.98             0       23.41      6000.0   
          158               6628.37             0        0.00      7000.0   
          175               4189.51             0        0.93      4500.0   
          193                584.84             0        0.00      4500.0   
          195                189.35             0        0.00      4500.0   
          216               4262.55             0        7.18      5500.0   
          243               1259.55             0        0.00      7000.0   
          246               1743.76             0        0.00      5500.0   
          267               2864.82             0        0.00      5500.0   
          270               3330.35             0       12.75      5500.0   
          289                 49.65             0        0.00     11500.0   
          292               7781.10             0        5.09     11500.0   
          302              10077.39             0        0.00     10000.0   
          314                960.88             1        1.48     10000.0   
          {\ldots}                   {\ldots}           {\ldots}         {\ldots}         {\ldots}   
          980409             614.02             0        0.00     16000.0   
          980414            4651.58             1        0.00      6000.0   
          980417            4975.48             0        0.00      6000.0   
          980429            4298.82             0        0.00      6500.0   
          980438            7216.19             0        0.00     10500.0   
          980471             712.39             1        0.00      8000.0   
          980474            1839.68             0        5.47      8000.0   
          980481            2140.12             0        0.00      8000.0   
          980490            7185.45             1        0.98      8500.0   
          980495            8093.62             0        0.00      8500.0   
          980500            3649.88             0        0.00      8500.0   
          980514            1383.13             0       29.28      4500.0   
          980520            1538.54             0        0.00      7500.0   
          980549             734.25             0        0.00     10500.0   
          980593            5360.79             0        0.00      6000.0   
          980594              50.24             0        0.00      6000.0   
          980603            1683.02             0        2.90      2000.0   
          980604            1090.14             0        1.12      2000.0   
          980619              56.04             1        1.72      2000.0   
          980636            2063.34             0        3.15      4500.0   
          980645             154.76             0        0.00      4000.0   
          980646            3072.32             0        0.00      4000.0   
          980657             754.35             0        0.00      5500.0   
          980679            6850.67             0       17.22      9000.0   
          980713             901.90             0        1.29      1000.0   
          980730              50.36             0        0.00     11000.0   
          980773             296.43             0        0.00      4000.0   
          980799            6619.72             0        0.00      6500.0   
          980803            2046.76             1        1.26      2500.0   
          980805              41.28             0       10.07      2500.0   
          
                  dif\_divida\_limite  dif\_divida\_gasto  
          1                0.189877          0.811095  
          30               0.537606          0.974537  
          39               0.000815          0.994242  
          44               0.863854          0.987480  
          45               0.151045          0.933590  
          58               0.926324          0.938585  
          71               0.532975          0.919998  
          73               0.071563          0.872186  
          74               0.952603          0.997756  
          79               0.893196          0.902974  
          81               0.065324          0.969163  
          83               0.036188          0.881374  
          92               0.498816          0.996291  
          96               0.105703          0.919769  
          116              0.739290          0.976843  
          139              0.028928          0.826124  
          148              0.494735          0.979572  
          158              0.972900          0.994498  
          175              0.985072          0.991325  
          193              0.137512          0.962019  
          195              0.044522          0.969137  
          216              0.778122          0.801730  
          243              0.175230          0.937919  
          246              0.331073          0.940484  
          267              0.543919          0.952682  
          270              0.632305          0.813133  
          289              0.004383          0.884711  
          292              0.686830          0.808813  
          302              0.983448          0.999927  
          314              0.093772          0.998296  
          {\ldots}                   {\ldots}               {\ldots}  
          980409           0.038173          0.998114  
          980414           0.744491          0.863162  
          980417           0.796332          0.917640  
          980429           0.637334          0.965695  
          980438           0.702374          0.838001  
          980471           0.089631          0.990572  
          980474           0.231465          0.924839  
          980481           0.269265          0.812977  
          980490           0.840994          0.991088  
          980495           0.947287          0.958853  
          980500           0.427186          0.836731  
          980514           0.305125          0.899626  
          980520           0.205852          0.883959  
          980549           0.070384          0.985451  
          980593           0.914187          0.940402  
          980594           0.008568          0.815320  
          980603           0.873842          0.985161  
          980604           0.566012          0.912977  
          980619           0.027936          0.947903  
          980636           0.454680          0.986885  
          980645           0.040397          0.926263  
          980646           0.801963          0.981183  
          980657           0.135164          0.933590  
          980679           0.754562          0.975205  
          980713           0.951371          0.960828  
          980730           0.004546          0.884595  
          980773           0.078859          0.995366  
          980799           0.994699          0.996274  
          980803           0.777940          0.946973  
          980805           0.015690          0.937330  
          
          [80396 rows x 10 columns]
\end{Verbatim}
            
    \subsubsection{Não pagamento médio por
mes}\label{nuxe3o-pagamento-muxe9dio-por-mes}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}473}]:} \PY{n}{inad\PYZus{}med\PYZus{}mes} \PY{o}{=}\PY{n}{df\PYZus{}divida}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dif\PYZus{}divida\PYZus{}gasto}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
          \PY{n}{inad\PYZus{}med\PYZus{}mes}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bar}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}473}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x17082f898>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_26_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{Conclusão}\label{conclusuxe3o}

\begin{itemize}
\tightlist
\item
  O tempo de antiguidade do cliente \textbf{não é um fator} influente na
  inadiplência.
\item
  A média de inadiplencia é muito alta 15\% para qualquer carteira de
  crédito o que nos desconfia que essa base tem apenas cliente que
  tiveram atraso
\end{itemize}

\section{Aonde concentra o maior capital devido
?}\label{aonde-concentra-o-maior-capital-devido}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}474}]:} \PY{c+c1}{\PYZsh{} O cliente pagou deve menos de 6\PYZpc{} do gasto o que provavelmente deve ser fatura paga com atraso }
          \PY{c+c1}{\PYZsh{}faturas\PYZus{}atraso  = df\PYZus{}divida[[\PYZsq{}dif\PYZus{}divida\PYZus{}gasto\PYZsq{}]].query(\PYZsq{}dif\PYZus{}divida\PYZus{}gasto \PYZgt{}= 0.17\PYZsq{})}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}475}]:} \PY{n}{df\PYZus{}divida}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}475}]:}          credit\_line          month         spends  revolving\_balance  \textbackslash{}
          count  980818.000000  980818.000000  980818.000000      980818.000000   
          mean     6450.701643      12.103346    2878.074202         481.071351   
          std      4564.596250       8.515882    3529.032134        1431.827450   
          min       506.000000       0.000000       0.000000           0.000000   
          25\%      2948.000000       5.000000     334.760000           0.000000   
          50\%      5314.000000      11.000000    1568.165000           1.530000   
          75\%      8763.000000      18.000000    4129.000000         141.660000   
          max     20484.000000      35.000000   20462.230000       20369.440000   
          
                  card\_request     minutes\_cs     cat\_credit  dif\_divida\_limite  \textbackslash{}
          count  980818.000000  980818.000000  980818.000000      980818.000000   
          mean        0.092795       2.791051    6451.613857           0.074523   
          std         0.290145       6.644611    4566.599247           0.181453   
          min         0.000000       0.000000     500.000000           0.000000   
          25\%         0.000000       0.000000    3000.000000           0.000000   
          50\%         0.000000       0.000000    5500.000000           0.000302   
          75\%         0.000000       1.720000    9000.000000           0.029994   
          max         1.000000      75.580000   20500.000000           1.000000   
          
                 dif\_divida\_gasto  
          count     980818.000000  
          mean           0.156652  
          std            0.290980  
          min            0.000000  
          25\%            0.000000  
          50\%            0.001249  
          75\%            0.134578  
          max            1.000000  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}476}]:} \PY{c+c1}{\PYZsh{}df\PYZus{}divida.dif\PYZus{}divida\PYZus{}gasto}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}477}]:} \PY{c+c1}{\PYZsh{}Faturas que tiveram pagamento menor q o gasto }
          \PY{n}{grupos} \PY{o}{=} \PY{n}{df\PYZus{}divida}\PY{o}{.}\PY{n}{query}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dif\PYZus{}divida\PYZus{}gasto \PYZgt{}0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{grupos} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{cut}\PY{p}{(}\PY{n}{grupos}\PY{o}{.}\PY{n}{dif\PYZus{}divida\PYZus{}gasto}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}calcula o percentual de fatura}
          \PY{n}{grupos\PYZus{}perc} \PY{o}{=} \PY{n}{grupos}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{n}{sort}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
          \PY{n}{grupos\PYZus{}perc}\PY{p}{[}\PY{p}{:}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{n}{grupos\PYZus{}perc} \PY{o}{/} \PY{n}{grupos\PYZus{}perc}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{o}{*} \PY{l+m+mi}{100}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}478}]:} \PY{n}{graficoPercDiv} \PY{o}{=} \PY{n}{grupos\PYZus{}perc}
          \PY{n}{graficoPercDiv}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{barh}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)} \PY{p}{,} \PY{n}{title}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{ Devido da fatura}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PYZbs{}
                                  \PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{xlabel}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{} F}\PY{l+s+s2}{aturas}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ylabel}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Faixa em }\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}478}]:} [Text(0, 0.5, 'Faixa em \% '), Text(0.5, 0, '\% Faturas')]
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_32_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{Capital devido por faixa de percentual de atraso Quantidade de
cliente}\label{capital-devido-por-faixa-de-percentual-de-atraso-quantidade-de-cliente}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}479}]:} \PY{c+c1}{\PYZsh{}maior mes de cada cliente }
          \PY{n}{ultima\PYZus{}fatura\PYZus{}cliente} \PY{o}{=} \PY{n}{df\PYZus{}spend\PYZus{}train}
          \PY{n}{ultima\PYZus{}fatura\PYZus{}cliente} \PY{o}{=} \PY{n}{ultima\PYZus{}fatura\PYZus{}cliente}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ids}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ids}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{as\PYZus{}index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}480}]:} \PY{c+c1}{\PYZsh{}ultima\PYZus{}fatura\PYZus{}cliente = df\PYZus{}spend\PYZus{}train[df\PYZus{}spend\PYZus{}train]}
          \PY{n+nb}{type}\PY{p}{(}\PY{n}{ultima\PYZus{}fatura\PYZus{}cliente}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}480}]:} pandas.core.frame.DataFrame
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}481}]:} \PY{n}{ultima\PYZus{}fatura\PYZus{}cliente\PYZus{}merge} \PY{o}{=} \PY{n}{ultima\PYZus{}fatura\PYZus{}cliente}\PY{o}{.}\PY{n}{merge}\PY{p}{(} \PY{n}{df\PYZus{}spend\PYZus{}train} \PY{p}{,}\PY{n}{on}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ids}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{inner}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ultima\PYZus{}fatura\PYZus{}cliente\PYZus{}merge}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}481}]:}                                         ids  month  credit\_line    spends  \textbackslash{}
          0      0003da40-123b-031a-63b3-f7c9f18516ab     17        20314  16728.28   
          1      0004a450-07bd-c652-8473-4e9dedcff8b8     18        19973   3380.81   
          2      0005967a-2048-6197-a054-30954efe93b1      8        11728    720.39   
          3      0009b1d5-f5c3-428e-63dd-39b5f04ad7df     19         3117   1077.98   
          4      0010b103-a9e4-e08f-ce04-0c65e71a6df9     12        20000   5058.40   
          5      0010e9b7-c5b2-7944-4ddb-88dc5ad6da65     21        20000   3712.98   
          6      00141481-d30b-2cb1-fefc-dae26098bda6     23         6704   5119.09   
          7      0015133f-867d-7086-a0ff-d50e95c4a615     23         3686    160.02   
          8      00179c95-2064-da76-3de6-b3d3c40e05cb     25         8676    489.34   
          9      0017e8b2-29ec-4fa2-5467-77f636830a19     14        20000      0.00   
          10     00187195-cd9b-c760-62ba-a4c48a4b85ac     16         1727   1370.86   
          11     0019005a-c0ad-3f4f-1179-2acf37cb0cb0     19         1474    733.69   
          12     001a5036-7fc0-0307-97f6-6c6814d8f1d1     35         4745   4542.67   
          13     001b5d39-e5f2-1388-0979-ce36d79253e0      5         8212    158.49   
          14     001b7193-0a0a-845a-b503-cadaa61e266a     19         3083   1773.61   
          15     001bd268-bce9-d656-7f5e-885f77942162     20          800      0.00   
          16     001c2243-b544-d7b4-cfa8-796a01721935     20         2282    441.12   
          17     001cc3fc-9cf9-b2db-bf8e-2727650dca1f     33        15710  10794.39   
          18     001edd9d-c17f-1b7a-a17b-716539c29421     27         5052   2812.32   
          19     0022ee26-c6e6-fcae-0ac0-4d5d110fd09a     20         6816    128.02   
          20     00233cc4-3de5-f810-d18a-fcc353394fb6     17         7443    658.58   
          21     0023b4ee-5fa0-de01-888e-d20236a19510     28          842    233.00   
          22     00240095-0de7-5af2-8d04-d33eef21fe43     23         2389   1606.15   
          23     0024464f-6a5b-0be0-08cc-6f7c63b96448     23         2408    857.10   
          24     0025e1ee-57ff-9ac0-c519-94f284270636     12         3471   1889.75   
          25     002718d2-88fd-8c09-cc8b-9b8ea3c45053     18        14207   4643.39   
          26     00291cf1-ab10-de65-1f2c-7d3367e40a18     16         3707   3643.45   
          27     002b83b9-302c-1b64-f441-cfa545803746     13         1366    297.11   
          28     002f02c6-67f5-9837-90bd-118c306e79e6     13         1826    476.21   
          29     002f7113-39b6-4bf6-d4e8-af6419bb6ecb     21        11254   5224.46   
          {\ldots}                                     {\ldots}    {\ldots}          {\ldots}       {\ldots}   
          44970  ffca8909-8f09-c76c-f9f1-77ebe5b28b3f      3         9585   7516.37   
          44971  ffcaae41-dbe9-5862-c80e-40b5680809ac     14         2785   2663.10   
          44972  ffcc32d4-2f95-71c0-6df6-57574f06f016     21        20000   3712.98   
          44973  ffce7aed-2e86-96d3-fca8-519657d12345     26         7817   3909.91   
          44974  ffcf46bd-57ae-2589-f7d0-de61c23b0490     21         5873   5350.48   
          44975  ffd27f48-2559-348e-a344-597c610feb62     33         4043   3897.30   
          44976  ffd4dbdf-ae22-dad8-390f-efdb443c400c     13          691     30.83   
          44977  ffd5c806-0542-5009-48e9-aeef01e2082e     21         3542    378.55   
          44978  ffd6fa1b-f383-9533-9fb2-fe1ea0a1467e     15         4225   4144.51   
          44979  ffdbd1ef-e2e4-ad00-96de-2e851bee8f02     11         3589      0.00   
          44980  ffdbf3ec-3fe3-e561-f6a8-f585cce61353      7         1905     17.14   
          44981  ffde0322-4ed2-ced4-baa1-e582c495fccb     12         1725     21.93   
          44982  ffde9ca6-f8b7-28a2-05ca-3aa1d92c4530     18        15910  15341.58   
          44983  ffdf4eee-9b1a-cad8-2084-b4ff5a83bf21     25         1231   1227.46   
          44984  ffe2c28b-6451-77d6-f400-3cb52032d7aa     28         3664    829.16   
          44985  ffe392ea-1f0a-7ce3-9da0-2690a4cee8a9     34        18612   1071.88   
          44986  ffe7702c-ef41-288a-a64a-f58639a9717f     12         1195    383.60   
          44987  ffe7971c-bb90-2ff3-b66e-1d007917ffbd     11         3038   1136.56   
          44988  ffe9497d-a05b-452d-d2b3-37d490a37c2e     13         5527    250.50   
          44989  ffe9c5b1-a43d-bccb-6d4e-82d09ecb56ca     12         2566   1134.89   
          44990  ffea60dc-3fbb-d28c-5408-d82015ca9ba1     24         1244    978.68   
          44991  ffee8f92-5c62-7ae1-3341-2da30db6b822     10         7182      0.00   
          44992  ffef9ad0-91d0-4204-0fc5-9b210b170797     32         6684   5210.27   
          44993  ffefbdc6-7535-68d6-cb1b-cc24323f7f20     33         7111    387.96   
          44994  fff24e67-4722-871a-58c2-eb0612cf86ff     22        13334   3816.66   
          44995  fff382c5-e5f1-18fe-8cad-9e21d95bae35     25         9297   3837.72   
          44996  fff655c7-ab69-dd3c-3a38-a43a831c0c03     31         7057   6927.90   
          44997  fffafeb2-97a7-498e-f9ed-81e9d0e328ca     17         4012   2749.68   
          44998  fffb457c-2091-1f6f-431a-02fa95ed34a1     18        12227  10295.89   
          44999  fffea38d-8377-4a53-c80d-a472a7427d64     24         5250   1556.86   
          
                 revolving\_balance  card\_request  minutes\_cs  cat\_credit  \textbackslash{}
          0                5709.69             0        0.00     20500.0   
          1                3361.00             0        0.00     20000.0   
          2                  10.90             0        0.00     11500.0   
          3                  12.68             0        0.00      3000.0   
          4                 141.01             0        0.00     20000.0   
          5                   0.00             1        2.91     20000.0   
          6                   6.70             0       10.73      6500.0   
          7                  97.14             0       22.31      3500.0   
          8                   0.00             0        0.00      8500.0   
          9                   0.00             0        0.00     20000.0   
          10                  3.64             0        0.00      1500.0   
          11                726.27             0        0.00      1500.0   
          12                  0.00             1       42.46      4500.0   
          13                  0.00             0        0.00      8000.0   
          14                801.38             0        5.45      3000.0   
          15                  0.00             0        0.00      1000.0   
          16                364.42             0        0.00      2500.0   
          17               1297.34             0        0.00     15500.0   
          18               1139.70             0        0.00      5000.0   
          19                 99.26             0        0.00      7000.0   
          20                 15.52             0        0.00      7500.0   
          21                  0.00             0        6.65      1000.0   
          22               1345.48             0        0.00      2500.0   
          23                  0.04             0        0.00      2500.0   
          24                 22.95             0        0.00      3500.0   
          25               4340.91             0        0.00     14000.0   
          26                 29.70             0        0.00      3500.0   
          27                295.73             0       11.04      1500.0   
          28                 77.36             1       19.51      2000.0   
          29               2350.17             0       21.16     11500.0   
          {\ldots}                  {\ldots}           {\ldots}         {\ldots}         {\ldots}   
          44970               0.50             0        0.00      9500.0   
          44971              28.51             1       23.23      3000.0   
          44972               0.00             1        2.91     20000.0   
          44973            3721.34             0        0.00      8000.0   
          44974             464.08             0        0.00      6000.0   
          44975               0.00             0        0.00      4000.0   
          44976               2.41             0        0.00       500.0   
          44977             256.80             0        0.00      3500.0   
          44978               0.00             0       10.69      4000.0   
          44979               0.00             0        0.00      3500.0   
          44980               0.00             1       12.02      2000.0   
          44981               0.00             0        0.00      1500.0   
          44982               0.00             0        0.29     16000.0   
          44983               0.09             0        0.00      1000.0   
          44984               0.00             0        0.00      3500.0   
          44985               0.27             0        0.00     18500.0   
          44986               2.47             0        0.00      1000.0   
          44987               0.00             0        0.00      3000.0   
          44988               0.00             0        0.00      5500.0   
          44989               0.00             0        0.00      2500.0   
          44990              55.85             0        0.00      1000.0   
          44991               0.00             0        0.21      7000.0   
          44992              52.27             0        0.00      6500.0   
          44993              42.26             0        0.00      7000.0   
          44994               0.00             0        0.00     13500.0   
          44995            2577.28             0        0.00      9500.0   
          44996               0.00             0        0.00      7000.0   
          44997               0.00             1       13.02      4000.0   
          44998            7443.69             0       12.02     12000.0   
          44999              93.13             0        1.34      5000.0   
          
                 dif\_divida\_limite  dif\_divida\_gasto  
          0               0.281072          0.341320  
          1               0.168277          0.994140  
          2               0.000929          0.015131  
          3               0.004068          0.011763  
          4               0.007050          0.027876  
          5               0.000000          0.000000  
          6               0.000999          0.001309  
          7               0.026354          0.607049  
          8               0.000000          0.000000  
          9               0.000000          0.000000  
          10              0.002108          0.002655  
          11              0.492720          0.989887  
          12              0.000000          0.000000  
          13              0.000000          0.000000  
          14              0.259935          0.451836  
          15              0.000000          0.000000  
          16              0.159693          0.826124  
          17              0.082581          0.120187  
          18              0.225594          0.405253  
          19              0.014563          0.775348  
          20              0.002085          0.023566  
          21              0.000000          0.000000  
          22              0.563198          0.837705  
          23              0.000017          0.000047  
          24              0.006612          0.012144  
          25              0.305547          0.934858  
          26              0.008012          0.008152  
          27              0.216493          0.995355  
          28              0.042366          0.162449  
          29              0.208830          0.449840  
          {\ldots}                  {\ldots}               {\ldots}  
          44970           0.000052          0.000067  
          44971           0.010237          0.010706  
          44972           0.000000          0.000000  
          44973           0.476057          0.951771  
          44974           0.079019          0.086736  
          44975           0.000000          0.000000  
          44976           0.003488          0.078171  
          44977           0.072501          0.678378  
          44978           0.000000          0.000000  
          44979           0.000000          0.000000  
          44980           0.000000          0.000000  
          44981           0.000000          0.000000  
          44982           0.000000          0.000000  
          44983           0.000073          0.000073  
          44984           0.000000          0.000000  
          44985           0.000015          0.000252  
          44986           0.002067          0.006439  
          44987           0.000000          0.000000  
          44988           0.000000          0.000000  
          44989           0.000000          0.000000  
          44990           0.044895          0.057067  
          44991           0.000000          0.000000  
          44992           0.007820          0.010032  
          44993           0.005943          0.108929  
          44994           0.000000          0.000000  
          44995           0.277216          0.671565  
          44996           0.000000          0.000000  
          44997           0.000000          0.000000  
          44998           0.608791          0.722977  
          44999           0.017739          0.059819  
          
          [45000 rows x 10 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}482}]:} \PY{n}{ultima\PYZus{}fatura\PYZus{}cliente\PYZus{}merge} \PY{o}{=} \PY{n}{ultima\PYZus{}fatura\PYZus{}cliente\PYZus{}merge}\PY{o}{.}\PY{n}{query}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{revolving\PYZus{}balance \PYZgt{}0 }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ultima\PYZus{}fatura\PYZus{}cliente\PYZus{}merge}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}482}]:}                                         ids  month  credit\_line    spends  \textbackslash{}
          0      0003da40-123b-031a-63b3-f7c9f18516ab     17        20314  16728.28   
          1      0004a450-07bd-c652-8473-4e9dedcff8b8     18        19973   3380.81   
          2      0005967a-2048-6197-a054-30954efe93b1      8        11728    720.39   
          3      0009b1d5-f5c3-428e-63dd-39b5f04ad7df     19         3117   1077.98   
          4      0010b103-a9e4-e08f-ce04-0c65e71a6df9     12        20000   5058.40   
          6      00141481-d30b-2cb1-fefc-dae26098bda6     23         6704   5119.09   
          7      0015133f-867d-7086-a0ff-d50e95c4a615     23         3686    160.02   
          10     00187195-cd9b-c760-62ba-a4c48a4b85ac     16         1727   1370.86   
          11     0019005a-c0ad-3f4f-1179-2acf37cb0cb0     19         1474    733.69   
          14     001b7193-0a0a-845a-b503-cadaa61e266a     19         3083   1773.61   
          16     001c2243-b544-d7b4-cfa8-796a01721935     20         2282    441.12   
          17     001cc3fc-9cf9-b2db-bf8e-2727650dca1f     33        15710  10794.39   
          18     001edd9d-c17f-1b7a-a17b-716539c29421     27         5052   2812.32   
          19     0022ee26-c6e6-fcae-0ac0-4d5d110fd09a     20         6816    128.02   
          20     00233cc4-3de5-f810-d18a-fcc353394fb6     17         7443    658.58   
          22     00240095-0de7-5af2-8d04-d33eef21fe43     23         2389   1606.15   
          23     0024464f-6a5b-0be0-08cc-6f7c63b96448     23         2408    857.10   
          24     0025e1ee-57ff-9ac0-c519-94f284270636     12         3471   1889.75   
          25     002718d2-88fd-8c09-cc8b-9b8ea3c45053     18        14207   4643.39   
          26     00291cf1-ab10-de65-1f2c-7d3367e40a18     16         3707   3643.45   
          27     002b83b9-302c-1b64-f441-cfa545803746     13         1366    297.11   
          28     002f02c6-67f5-9837-90bd-118c306e79e6     13         1826    476.21   
          29     002f7113-39b6-4bf6-d4e8-af6419bb6ecb     21        11254   5224.46   
          30     003098e2-d4a0-6719-a938-9cb54f60062e     31         5458     37.34   
          31     0030a536-ac21-2893-5731-08f83b58c988     25         5694    275.75   
          32     003264af-8ca7-6b61-4b51-6c818f90d1f4     29         4144   3733.64   
          34     003422e5-2f8d-b7b1-0f53-93db9b2aa608     21         5685    159.47   
          35     00377e04-397a-af46-aec4-12e687cefe56     23         5043   4807.13   
          36     00389c9b-2871-40d1-c4c9-7eae4a862ba4     16        17710    851.22   
          37     003d5435-2510-b39e-4d6e-f4f21e6476a5     33         7326   1799.83   
          {\ldots}                                     {\ldots}    {\ldots}          {\ldots}       {\ldots}   
          44946  ffab3671-5a56-e617-9ad9-bbe7c150e491     17         1911   1695.07   
          44948  ffac3b79-8bc9-6c69-7111-282b3f78316b     11        15065   3618.55   
          44949  ffad4651-4718-0294-9f47-2611a0b66d10     29         8062    544.78   
          44952  ffb04184-477b-7c06-9ab3-0e0e07665003      5        13869   2111.99   
          44953  ffb147b7-ddb7-892c-1906-23c2fa7e8642     16         5358    103.50   
          44954  ffb227b6-11eb-261b-0a30-e145b2aa5a7c     26         8362   8031.21   
          44956  ffb3280e-2820-dc13-42f6-e5ad6f266529      7         2346    254.24   
          44958  ffb795ed-3973-b603-ec58-b3e146152214      9         4137   4136.38   
          44959  ffb81b70-c3a0-51ef-8529-caffe97c9034     15        14030    856.08   
          44960  ffbacace-1df6-166a-9c4e-931e02c3ac59     29         4374    209.53   
          44961  ffbd1c8c-07df-4ed6-51ee-793cc07fb271     14         4558   2422.41   
          44962  ffbe08c4-d3c8-a62c-06b0-ef6e2b62bd63     15         3386   3139.20   
          44965  ffc50f94-e983-be9b-892e-2a6f6dc9da81     29         4777    790.76   
          44967  ffc8b8e7-5e08-201e-3cc4-b9fdd32ec751     32         7347    174.50   
          44968  ffc8dd11-187f-04a5-44f6-2a5ca81de62c     24        14521  10062.78   
          44970  ffca8909-8f09-c76c-f9f1-77ebe5b28b3f      3         9585   7516.37   
          44971  ffcaae41-dbe9-5862-c80e-40b5680809ac     14         2785   2663.10   
          44973  ffce7aed-2e86-96d3-fca8-519657d12345     26         7817   3909.91   
          44974  ffcf46bd-57ae-2589-f7d0-de61c23b0490     21         5873   5350.48   
          44976  ffd4dbdf-ae22-dad8-390f-efdb443c400c     13          691     30.83   
          44977  ffd5c806-0542-5009-48e9-aeef01e2082e     21         3542    378.55   
          44983  ffdf4eee-9b1a-cad8-2084-b4ff5a83bf21     25         1231   1227.46   
          44985  ffe392ea-1f0a-7ce3-9da0-2690a4cee8a9     34        18612   1071.88   
          44986  ffe7702c-ef41-288a-a64a-f58639a9717f     12         1195    383.60   
          44990  ffea60dc-3fbb-d28c-5408-d82015ca9ba1     24         1244    978.68   
          44992  ffef9ad0-91d0-4204-0fc5-9b210b170797     32         6684   5210.27   
          44993  ffefbdc6-7535-68d6-cb1b-cc24323f7f20     33         7111    387.96   
          44995  fff382c5-e5f1-18fe-8cad-9e21d95bae35     25         9297   3837.72   
          44998  fffb457c-2091-1f6f-431a-02fa95ed34a1     18        12227  10295.89   
          44999  fffea38d-8377-4a53-c80d-a472a7427d64     24         5250   1556.86   
          
                 revolving\_balance  card\_request  minutes\_cs  cat\_credit  \textbackslash{}
          0                5709.69             0        0.00     20500.0   
          1                3361.00             0        0.00     20000.0   
          2                  10.90             0        0.00     11500.0   
          3                  12.68             0        0.00      3000.0   
          4                 141.01             0        0.00     20000.0   
          6                   6.70             0       10.73      6500.0   
          7                  97.14             0       22.31      3500.0   
          10                  3.64             0        0.00      1500.0   
          11                726.27             0        0.00      1500.0   
          14                801.38             0        5.45      3000.0   
          16                364.42             0        0.00      2500.0   
          17               1297.34             0        0.00     15500.0   
          18               1139.70             0        0.00      5000.0   
          19                 99.26             0        0.00      7000.0   
          20                 15.52             0        0.00      7500.0   
          22               1345.48             0        0.00      2500.0   
          23                  0.04             0        0.00      2500.0   
          24                 22.95             0        0.00      3500.0   
          25               4340.91             0        0.00     14000.0   
          26                 29.70             0        0.00      3500.0   
          27                295.73             0       11.04      1500.0   
          28                 77.36             1       19.51      2000.0   
          29               2350.17             0       21.16     11500.0   
          30                 27.03             0        0.00      5500.0   
          31                  0.12             0        0.00      5500.0   
          32               3428.43             0        0.00      4000.0   
          34                112.83             0        0.00      5500.0   
          35               3847.63             0        0.00      5000.0   
          36                  0.02             0        0.00     17500.0   
          37                 31.60             0        0.00      7500.0   
          {\ldots}                  {\ldots}           {\ldots}         {\ldots}         {\ldots}   
          44946             777.73             0        9.19      2000.0   
          44948               4.76             0        7.05     15000.0   
          44949               3.23             0        0.00      8000.0   
          44952               3.00             0        0.00     14000.0   
          44953               0.77             0        6.89      5500.0   
          44954            3512.38             0        0.44      8500.0   
          44956               0.77             0        6.65      2500.0   
          44958             804.31             0        0.00      4000.0   
          44959               0.06             0        0.00     14000.0   
          44960             128.65             0        0.00      4500.0   
          44961               0.57             0        0.00      4500.0   
          44962            2547.60             0       14.68      3500.0   
          44965               2.15             0        0.00      5000.0   
          44967               0.09             0        0.00      7500.0   
          44968             360.46             0        0.00     14500.0   
          44970               0.50             0        0.00      9500.0   
          44971              28.51             1       23.23      3000.0   
          44973            3721.34             0        0.00      8000.0   
          44974             464.08             0        0.00      6000.0   
          44976               2.41             0        0.00       500.0   
          44977             256.80             0        0.00      3500.0   
          44983               0.09             0        0.00      1000.0   
          44985               0.27             0        0.00     18500.0   
          44986               2.47             0        0.00      1000.0   
          44990              55.85             0        0.00      1000.0   
          44992              52.27             0        0.00      6500.0   
          44993              42.26             0        0.00      7000.0   
          44995            2577.28             0        0.00      9500.0   
          44998            7443.69             0       12.02     12000.0   
          44999              93.13             0        1.34      5000.0   
          
                 dif\_divida\_limite  dif\_divida\_gasto  
          0               0.281072          0.341320  
          1               0.168277          0.994140  
          2               0.000929          0.015131  
          3               0.004068          0.011763  
          4               0.007050          0.027876  
          6               0.000999          0.001309  
          7               0.026354          0.607049  
          10              0.002108          0.002655  
          11              0.492720          0.989887  
          14              0.259935          0.451836  
          16              0.159693          0.826124  
          17              0.082581          0.120187  
          18              0.225594          0.405253  
          19              0.014563          0.775348  
          20              0.002085          0.023566  
          22              0.563198          0.837705  
          23              0.000017          0.000047  
          24              0.006612          0.012144  
          25              0.305547          0.934858  
          26              0.008012          0.008152  
          27              0.216493          0.995355  
          28              0.042366          0.162449  
          29              0.208830          0.449840  
          30              0.004952          0.723889  
          31              0.000021          0.000435  
          32              0.827324          0.918254  
          34              0.019847          0.707531  
          35              0.762965          0.800401  
          36              0.000001          0.000023  
          37              0.004313          0.017557  
          {\ldots}                  {\ldots}               {\ldots}  
          44946           0.406975          0.458819  
          44948           0.000316          0.001315  
          44949           0.000401          0.005929  
          44952           0.000216          0.001420  
          44953           0.000144          0.007440  
          44954           0.420041          0.437341  
          44956           0.000328          0.003029  
          44958           0.194419          0.194448  
          44959           0.000004          0.000070  
          44960           0.029412          0.613993  
          44961           0.000125          0.000235  
          44962           0.752392          0.811544  
          44965           0.000450          0.002719  
          44967           0.000012          0.000516  
          44968           0.024823          0.035821  
          44970           0.000052          0.000067  
          44971           0.010237          0.010706  
          44973           0.476057          0.951771  
          44974           0.079019          0.086736  
          44976           0.003488          0.078171  
          44977           0.072501          0.678378  
          44983           0.000073          0.000073  
          44985           0.000015          0.000252  
          44986           0.002067          0.006439  
          44990           0.044895          0.057067  
          44992           0.007820          0.010032  
          44993           0.005943          0.108929  
          44995           0.277216          0.671565  
          44998           0.608791          0.722977  
          44999           0.017739          0.059819  
          
          [30860 rows x 10 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}483}]:}  \PY{n}{bins} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{cut}\PY{p}{(}\PY{n}{ultima\PYZus{}fatura\PYZus{}cliente\PYZus{}merge}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dif\PYZus{}divida\PYZus{}gasto}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}bins.value\PYZus{}counts(sort=False)}
          \PY{n}{ultima\PYZus{}fatura\PYZus{}cliente\PYZus{}merge\PYZus{}bins} \PY{o}{=}\PY{n}{ultima\PYZus{}fatura\PYZus{}cliente\PYZus{}merge}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{bins} \PY{p}{)}\PYZbs{}
              \PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{revolving\PYZus{}balance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sum}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ids}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)} 
          \PY{n}{ultima\PYZus{}fatura\PYZus{}cliente\PYZus{}merge\PYZus{}bins} \PY{o}{=} \PY{n}{ultima\PYZus{}fatura\PYZus{}cliente\PYZus{}merge\PYZus{}bins}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ids}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{qtde}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{revolving\PYZus{}balance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}484}]:} \PY{n}{divida\PYZus{}consolidada} \PY{o}{=} \PY{n}{ultima\PYZus{}fatura\PYZus{}cliente\PYZus{}merge\PYZus{}bins}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
          \PY{n}{divida\PYZus{}consolidada}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total\PYZus{}perc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{divida\PYZus{}consolidada}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{divida\PYZus{}consolidada}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}
          \PY{n}{divida\PYZus{}consolidada}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{qtde\PYZus{}perc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{divida\PYZus{}consolidada}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{qtde}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{divida\PYZus{}consolidada}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{qtde}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}
          \PY{n}{divida\PYZus{}consolidada}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total\PYZus{}perc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{qtde\PYZus{}perc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False} \PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}484}]:}    dif\_divida\_gasto       total   qtde  total\_perc  qtde\_perc
          9        (0.9, 1.0]  7557010.72   2453   34.396409   7.948801
          8        (0.8, 0.9]  2827491.84   1244   12.869582   4.031108
          7        (0.7, 0.8]  2380599.37   1000   10.835511   3.240441
          5        (0.5, 0.6]  1882194.03    901    8.566974   2.919637
          6        (0.6, 0.7]  1700862.10    890    7.741626   2.883992
          4        (0.4, 0.5]  1413022.49   1028    6.431498   3.331173
          3        (0.3, 0.4]  1204197.79   1095    5.481014   3.548283
          2        (0.2, 0.3]  1102949.39   1414    5.020173   4.581983
          1        (0.1, 0.2]  1091352.95   2327    4.967390   7.540506
          0  (-0.000999, 0.1]   810667.06  18508    3.689824  59.974076
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}506}]:} \PY{n}{divida\PYZus{}consolidada}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dif\PYZus{}divida\PYZus{}gasto}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total\PYZus{}perc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{qtde\PYZus{}perc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{divida\PYZus{}consolidada}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dif\PYZus{}divida\PYZus{}gasto}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_40_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_40_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}485}]:} \PY{c+c1}{\PYZsh{} Criando um indicador de otimização qual grupo tem o maior dívida com menor quantidade de pessoas }
          \PY{c+c1}{\PYZsh{} Otimo = \PYZpc{}TotalR\PYZdl{} / (1 \PYZhy{} \PYZpc{}Clientes)}
          \PY{n}{divida\PYZus{}consolidada}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{otimo}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{n}{divida\PYZus{}consolidada}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total\PYZus{}perc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{l+m+mi}{100}\PY{p}{)}\PY{o}{*}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{p}{(}\PY{n}{divida\PYZus{}consolidada}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{qtde\PYZus{}perc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{l+m+mi}{100}\PY{p}{)}\PY{p}{)}
          \PY{n}{divida\PYZus{}consolidada}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{otimo}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}  \PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}485}]:}    dif\_divida\_gasto       total   qtde  total\_perc  qtde\_perc     otimo
          9        (0.9, 1.0]  7557010.72   2453   34.396409   7.948801  0.316623
          8        (0.8, 0.9]  2827491.84   1244   12.869582   4.031108  0.123508
          7        (0.7, 0.8]  2380599.37   1000   10.835511   3.240441  0.104844
          5        (0.5, 0.6]  1882194.03    901    8.566974   2.919637  0.083168
          6        (0.6, 0.7]  1700862.10    890    7.741626   2.883992  0.075184
          4        (0.4, 0.5]  1413022.49   1028    6.431498   3.331173  0.062173
          3        (0.3, 0.4]  1204197.79   1095    5.481014   3.548283  0.052865
          2        (0.2, 0.3]  1102949.39   1414    5.020173   4.581983  0.047901
          1        (0.1, 0.2]  1091352.95   2327    4.967390   7.540506  0.045928
          0  (-0.000999, 0.1]   810667.06  18508    3.689824  59.974076  0.014769
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}507}]:} \PY{n}{divida\PYZus{}consolidada}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dif\PYZus{}divida\PYZus{}gasto}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{otimo}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{barh}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}507}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x176dd47f0>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_42_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
